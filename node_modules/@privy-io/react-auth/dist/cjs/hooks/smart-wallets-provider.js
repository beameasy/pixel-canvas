"use strict";var e=require("react/jsx-runtime"),r=require("react"),i=require("../configuration/context.js"),n=require("../errors.js"),s=require("../lib/getEmbeddedConnectedWallet.js"),t=require("../lib/smart-wallets.js"),c=require("./internal-context.js"),a=require("./privy-context.js"),o=require("./useWallets.js");require("../config.js"),require("../configuration/defaultClientConfig.js"),require("../constants.js"),require("../configuration/login-methods.js"),require("../configuration/wallets.js"),require("../connectors/chains/index.js"),require("../connectors/chains/arbitrum.js"),require("../connectors/chains/arbitrumSepolia.js"),require("../connectors/chains/avalanche.js"),require("../connectors/chains/avalancheFuji.js"),require("../connectors/chains/base.js"),require("../connectors/chains/baseSepolia.js"),require("../connectors/chains/berachainArtio.js"),require("../connectors/chains/celo.js"),require("../connectors/chains/celoAlfajores.js"),require("../connectors/chains/filecoin.js"),require("../connectors/chains/filecoinCalibration.js"),require("../connectors/chains/garnetHolesky.js"),require("../connectors/chains/holesky.js"),require("../connectors/chains/linea.js"),require("../connectors/chains/lineaTestnet.js"),require("../connectors/chains/lukso.js"),require("../connectors/chains/mainnet.js"),require("../connectors/chains/optimism.js"),require("../connectors/chains/optimismSepolia.js"),require("../connectors/chains/polygon.js"),require("../connectors/chains/polygonAmoy.js"),require("../connectors/chains/redstone.js"),require("../connectors/chains/sepolia.js"),require("../connectors/chains/zora.js"),require("../connectors/chains/zoraSepolia.js"),require("../connectors/chains/zoraTestnet.js"),require("../connectors/chains/utils.js"),require("../lib/solana/index.js"),require("../theme.js"),require("tinycolor2"),require("../lib/cybr53.js"),require("ofetch"),require("viem"),require("../client/user.js"),require("viem/utils"),require("./modal-context.js"),require("../components/PrefetchedImage.js"),require("../screens/index.js"),require("./index.js"),require("./useSmartWalletChain.js"),require("../utils/eth/getPublicClient.js"),require("../lib/smart-wallets-shared.js"),require("permissionless"),require("permissionless/accounts"),require("permissionless/clients/pimlico"),require("viem/account-abstraction"),require("@privy-io/js-sdk-core");let l=/*#__PURE__*/r.createContext({client:void 0});let u=/*#__PURE__*/r.createContext({config:void 0}),d=()=>{let{config:e}=r.useContext(u);return{config:e}},h=({children:i})=>{let[n,s]=r.useState(void 0),{client:t}=c.usePrivyInternal();return r.useEffect((()=>{!n&&t&&(async()=>{try{if(!t)return void console.warn("No client found");let e=await t.getSmartWalletsConfig();s(e)}catch(e){console.warn("Error generating smart wallet config: ",e)}})()}),[!!t]),/*#__PURE__*/e.jsx(u.Provider,{value:{config:n},children:i})},q=({config:l,children:u})=>{let{config:h}=d(),{appId:q}=c.usePrivyInternal(),{chains:f,defaultChain:g,rpcConfig:m}=i.useAppConfig(),{wallets:p}=o.useWallets(),{user:v}=a.usePrivyContext(),[y,C]=r.useState(),x=s.getEmbeddedConnectedWallet(p);return r.useEffect((()=>{(async()=>{if(!h?.enabled)return;let e=h.configuredNetworks.find((e=>e.chainId===`eip155:${g.id}`))?g:f.find((e=>h.configuredNetworks.map((e=>e.chainId)).includes(`eip155:${e.id}`)));if(!e)throw new n.PrivyClientError("Could not find smart wallets chain configurations for any Privy client configured chains. Please configure smart wallets for your chains in the Privy dashboard.");C(await t.getSmartWalletClient({chain:e,privyAppId:q,paymasterContext:l?.paymasterContext,rpcConfig:m,embeddedWallet:x,user:v,smartWalletsConfig:h}))})()}),[!!h?.enabled,!!v?.smartWallet,!!x]),/*#__PURE__*/e.jsx(j.Provider,{value:{client:y,config:l},children:u})},j=/*#__PURE__*/r.createContext({client:void 0,config:void 0}),f=({children:i})=>{let{client:n,config:s}=(()=>{let{client:e,config:i}=r.useContext(j);return{client:e,config:i}})(),{config:o}=d(),{wrapSmartAccountClient:u}=t.useSmartWalletsWrapper({clientConfig:s,smartWalletsConfig:o}),{user:h}=a.usePrivyContext(),{generateSiweMessageForSmartWallet:q,linkSmartWallet:f,hideWalletUIs:g}=c.usePrivyInternal();return r.useEffect((()=>{(async()=>{if(n&&h&&!h?.smartWallet&&o?.enabled)try{let e=await q({address:n.account.address,chainId:`eip155:${n.chain.id}`});g.current=!0;let r=await n.signMessage({message:e});await f({signature:r,message:e,smartWalletType:o.smartWalletType})}catch(e){console.error("Error creating smart wallet:",e)}finally{g.current=!1}})()}),[!!n,!!h?.smartWallet,!!o?.enabled]),/*#__PURE__*/e.jsx(l.Provider,{value:{client:h?.smartWallet&&n?u(n):void 0},children:i})};exports.SmartWalletsProvider=({config:r,children:i})=>/*#__PURE__*/e.jsx(h,{children:/*#__PURE__*/e.jsx(q,{config:r,children:/*#__PURE__*/e.jsx(f,{children:i})})}),exports.useSmartWallets=()=>{let{client:e}=r.useContext(l);return{client:e}};
