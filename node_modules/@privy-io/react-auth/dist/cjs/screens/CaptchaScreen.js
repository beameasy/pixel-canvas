"use strict";var e=require("react/jsx-runtime"),r=require("./index.js"),n=require("@heroicons/react/24/solid/CheckCircleIcon"),i=require("@heroicons/react/24/solid/XCircleIcon"),s=require("react"),o=require("styled-components"),t=require("../components/Button.js"),c=require("../components/Layouts.js"),a=require("../components/ModalFooter.js"),u=require("../components/ModalHeader.js"),l=require("../components/WrappedLoader.js"),h=require("../hooks/captcha-context.js"),d=require("../hooks/modal-context.js");function j(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("../components/Loader.js"),require("../configuration/context.js"),require("../config.js"),require("../configuration/defaultClientConfig.js"),require("../constants.js"),require("../configuration/login-methods.js"),require("../configuration/wallets.js"),require("../connectors/chains/index.js"),require("../connectors/chains/arbitrum.js"),require("../connectors/chains/arbitrumSepolia.js"),require("../connectors/chains/avalanche.js"),require("../connectors/chains/avalancheFuji.js"),require("../connectors/chains/base.js"),require("../connectors/chains/baseSepolia.js"),require("../connectors/chains/berachainArtio.js"),require("../connectors/chains/celo.js"),require("../connectors/chains/celoAlfajores.js"),require("../connectors/chains/filecoin.js"),require("../connectors/chains/filecoinCalibration.js"),require("../connectors/chains/garnetHolesky.js"),require("../connectors/chains/holesky.js"),require("../connectors/chains/linea.js"),require("../connectors/chains/lineaTestnet.js"),require("../connectors/chains/lukso.js"),require("../connectors/chains/mainnet.js"),require("../connectors/chains/optimism.js"),require("../connectors/chains/optimismSepolia.js"),require("../connectors/chains/polygon.js"),require("../connectors/chains/polygonAmoy.js"),require("../connectors/chains/redstone.js"),require("../connectors/chains/sepolia.js"),require("../connectors/chains/zora.js"),require("../connectors/chains/zoraSepolia.js"),require("../connectors/chains/zoraTestnet.js"),require("../connectors/chains/utils.js"),require("../lib/solana/index.js"),require("../theme.js"),require("tinycolor2"),require("../lib/cybr53.js"),require("../svg/protected-by-privy.js"),require("@heroicons/react/24/outline/ArrowLeftIcon"),require("@heroicons/react/24/outline/ArrowRightIcon"),require("@heroicons/react/24/outline/QuestionMarkCircleIcon"),require("@heroicons/react/24/outline/XMarkIcon"),require("../hooks/internal-context.js"),require("../hooks/index.js"),require("../errors.js"),require("ofetch"),require("../utils/index.js"),require("../connectors/get-legacy-injected-providers.js"),require("../connectors/is-wallet-installed.js"),require("../utils/eth/getPublicClient.js"),require("viem"),require("../components/PrefetchedImage.js");var q=/*#__PURE__*/j(n),p=/*#__PURE__*/j(i);let f=/*#__PURE__*/o.styled.div.withConfig({displayName:"CaptchaContainer",componentId:"sc-9afcf974-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px;width:100%;"]);exports.CaptchaScreen=()=>{let{lastScreen:n,currentScreen:i,data:o,navigateBack:j,navigate:m,setModalData:g}=d.usePrivyModal(),{status:y,token:x,waitForResult:C,reset:k,execute:b}=h.useCaptcha(),v=s.useRef([]),S=e=>{v.current=[e,...v.current]},[w,I]=s.useState(!0);s.useEffect((()=>(S(setTimeout(I,1e3,!1)),()=>{v.current.forEach((e=>clearTimeout(e))),v.current=[]})),[]);let[M,R]=s.useState(""),[P,T]=s.useState("Checking that you are a human..."),[A,E]=s.useState(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:()=>{},disabled:!0,children:"Continue"})),[N,F]=s.useState(!1),[B,L]=s.useState(3),H=o?.captchaModalData,D=async e=>{try{await(H?.callback(e)),H?.onSuccessNavigateTo&&m(H?.onSuccessNavigateTo,!1)}catch(e){if(e instanceof h.CaptchaError)return;g({errorModalData:{error:e,previousScreen:n||r.ModalScreen.LANDING}}),m(H?.onErrorNavigateTo||r.ModalScreen.ERROR_SCREEN,!1)}};s.useEffect((()=>{"success"===y?S(setTimeout((async()=>{let e=await C();!e||H?.userIntentRequired||D(e)}),1e3)):"ready"===y&&S(setTimeout((()=>{"ready"===y&&b()}),500))}),[y]),s.useEffect((()=>{if(!w)switch(y){case"success":R("Success!"),T("CAPTCHA passed successfully."),E(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:()=>{F(!0),D(x)},disabled:!H?.userIntentRequired,loading:N,children:H?.userIntentRequired?"Continue":"Continuing..."}));break;case"loading":R(""),T("Checking that you are a human..."),E(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:()=>{},disabled:!0,children:"Continue"}));break;case"error":R("Something went wrong"),B<=0?(T("If you use an adblocker or VPN, try disabling and re-attempting."),E(null)):(T("You did not pass CAPTCHA. Please try again."),E(/*#__PURE__*/e.jsx(t.PrimaryButton,{onClick:z,children:"Retry"})))}}),[y,w,N]);let z=async()=>{if(B<=0)return;L((e=>e-1)),k(),b();let e=await C();!e||H?.userIntentRequired||D(e)};/*#__PURE__*/return e.jsxs(e.Fragment,{children:[/*#__PURE__*/e.jsx(u.ModalHeader,{backFn:n&&i!==n?j:void 0}),/*#__PURE__*/e.jsxs(f,{children:["success"===y?/*#__PURE__*/e.jsx(q.default,{fill:"var(--privy-color-success)",width:"64px",height:"64px"}):"error"===y?/*#__PURE__*/e.jsx(p.default,{fill:"var(--privy-color-error)",width:"64px",height:"64px"}):/*#__PURE__*/e.jsx(l.WrappedLoader,{}),/*#__PURE__*/e.jsxs(c.FixedGappedContainer,{children:[M?/*#__PURE__*/e.jsx("h3",{children:M}):null,/*#__PURE__*/e.jsx("p",{children:P})]}),A]}),/*#__PURE__*/e.jsx(a.ModalFooter,{})]})};
