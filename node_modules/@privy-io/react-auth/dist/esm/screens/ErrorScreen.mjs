import{jsx as t,jsxs as e,Fragment as o}from"react/jsx-runtime";import i from"@heroicons/react/24/outline/ExclamationTriangleIcon";import r from"@heroicons/react/24/outline/PhoneIcon";import{styled as n}from"styled-components";import{PrimaryButton as a}from"../components/Button.mjs";import{CircleBorder as c}from"../components/CircleBorder.mjs";import{ModalHeader as s}from"../components/ModalHeader.mjs";import m from"../components/layout/StackedContainer.mjs";import{PrivyIframeError as l}from"../embedded-wallets/errors.mjs";import{PrivyError as p,PrivyErrorCode as d,PrivyClientError as h,PrivyApiError as g}from"../errors.mjs";import{useCaptcha as T}from"../hooks/captcha-context.mjs";import{usePrivyModal as f}from"../hooks/modal-context.mjs";import{RelayRequestError as u}from"../lib/funding/reservoir.mjs";import{LockClosed as j}from"../svg/lock-closed.mjs";import{ModalScreen as y}from"./index.mjs";import"../components/Loader.mjs";import"@heroicons/react/24/outline/ArrowLeftIcon";import"@heroicons/react/24/outline/ArrowRightIcon";import"@heroicons/react/24/outline/QuestionMarkCircleIcon";import"@heroicons/react/24/outline/XMarkIcon";import"../configuration/context.mjs";import"react";import"../config.mjs";import"../configuration/defaultClientConfig.mjs";import"../constants.mjs";import"../configuration/login-methods.mjs";import"../configuration/wallets.mjs";import"../connectors/chains/index.mjs";import"../connectors/chains/arbitrum.mjs";import"../connectors/chains/arbitrumSepolia.mjs";import"../connectors/chains/avalanche.mjs";import"../connectors/chains/avalancheFuji.mjs";import"../connectors/chains/base.mjs";import"../connectors/chains/baseSepolia.mjs";import"../connectors/chains/berachainArtio.mjs";import"../connectors/chains/celo.mjs";import"../connectors/chains/celoAlfajores.mjs";import"../connectors/chains/filecoin.mjs";import"../connectors/chains/filecoinCalibration.mjs";import"../connectors/chains/garnetHolesky.mjs";import"../connectors/chains/holesky.mjs";import"../connectors/chains/linea.mjs";import"../connectors/chains/lineaTestnet.mjs";import"../connectors/chains/lukso.mjs";import"../connectors/chains/mainnet.mjs";import"../connectors/chains/optimism.mjs";import"../connectors/chains/optimismSepolia.mjs";import"../connectors/chains/polygon.mjs";import"../connectors/chains/polygonAmoy.mjs";import"../connectors/chains/redstone.mjs";import"../connectors/chains/sepolia.mjs";import"../connectors/chains/zora.mjs";import"../connectors/chains/zoraSepolia.mjs";import"../connectors/chains/zoraTestnet.mjs";import"../connectors/chains/utils.mjs";import"../lib/solana/index.mjs";import"../theme.mjs";import"tinycolor2";import"../lib/cybr53.mjs";import"../hooks/internal-context.mjs";import"../hooks/index.mjs";import"../embedded-wallets/types.mjs";import"ofetch";import"../utils/index.mjs";import"../connectors/get-legacy-injected-providers.mjs";import"../connectors/is-wallet-installed.mjs";import"../utils/eth/getPublicClient.mjs";import"viem";import"../components/PrefetchedImage.mjs";let C=(n,a)=>{let c=/*#__PURE__*/t(i,{height:38,width:38,stroke:"var(--privy-color-error)"});if(n instanceof u)return{title:"Transaction failed",detail:/*#__PURE__*/e(o,{children:[/*#__PURE__*/t("p",{children:n.message}),/*#__PURE__*/e("p",{children:["Check the"," ",/*#__PURE__*/t(I,{href:n.relayLink,target:"_blank",children:"refund status"}),"."]})]}),ctaText:"Try again",icon:c};if(n instanceof h)switch(n.privyErrorCode){case d.CLIENT_REQUEST_TIMEOUT:return{title:"Timed out",detail:n.message,ctaText:"Try again",icon:c};case d.INSUFFICIENT_BALANCE:return{title:"Insufficient balance",detail:n.message,ctaText:"Try again",icon:c};case d.TRANSACTION_FAILURE:return{title:"Transaction failure",detail:n.message,ctaText:"Try again",icon:c};default:return{title:"Something went wrong",detail:"Try again later",ctaText:"Try again",icon:c}}else{if(n instanceof l&&"twilio_verification_failed"===n.type)return{title:"Something went wrong",detail:n.message,ctaText:"Try again",icon:/*#__PURE__*/t(r,{height:38,width:38,stroke:"var(--privy-color-error)"})};if(!(n instanceof p))return n instanceof g&&n.status&&[400,422].includes(n.status)?{title:"Something went wrong",detail:n.message,ctaText:"Try again",icon:c}:{title:"Something went wrong",detail:"Try again later",ctaText:"Try again",icon:c};switch(n.privyErrorCode){case d.INVALID_CAPTCHA:return{title:"Something went wrong",detail:"Please try again.",ctaText:"Try again",icon:c};case d.DISALLOWED_LOGIN_METHOD:return{title:"Not allowed",detail:n.message,ctaText:"Try another method",icon:c};case d.ALLOWLIST_REJECTED:return{title:a.errorTitle||"You don't have access to this app",detail:a.errorDetail||"Have you been invited?",ctaText:a.errorCtaText||"Try another account",icon:/*#__PURE__*/t(j,{style:{width:"38px",height:"38px",strokeWidth:"1",stroke:"var(--privy-color-accent)",fill:"var(--privy-color-accent)"}})};case d.CAPTCHA_FAILURE:return{title:"Something went wrong",detail:"You did not pass CAPTCHA. Please try again.",ctaText:"Try again",icon:/*#__PURE__*/t("span",{})};case d.CAPTCHA_TIMEOUT:return{title:"Something went wrong",detail:"Something went wrong! Please try again later.",ctaText:"Try again",icon:/*#__PURE__*/t("span",{})};case d.LINKED_TO_ANOTHER_USER:return{title:"Authentication failed",detail:"This account has already been linked to another user.",ctaText:"Try again",icon:c};case d.NOT_SUPPORTED:return{title:"This region is not supported",detail:"SMS authentication from this region is not available",ctaText:"Try another method",icon:c};case d.TOO_MANY_REQUESTS:return{title:"Request failed",detail:"Too many attempts.",ctaText:"Try again later",icon:c};default:return{title:"Something went wrong",detail:"Try again later",ctaText:"Try again",icon:c}}}};const w=()=>{let{navigate:e,navigateBack:o,data:i,lastScreen:r,currentScreen:n}=f(),a=i?.errorModalData?.previousScreen||(r===n?void 0:r);/*#__PURE__*/return t(x,{error:i?.errorModalData?.error||Error(),backFn:()=>a?e(a,!1):o(),onClick:()=>e(a||y.LANDING,!1)})},x=({error:i,backFn:r,onClick:n})=>{let{reset:l}=T(),{app:h}=f(),g=C(i,h.allowlistConfig);/*#__PURE__*/return e(o,{children:[/*#__PURE__*/t(s,{backFn:r}),/*#__PURE__*/e(v,{children:[/*#__PURE__*/t(m,{children:/*#__PURE__*/e("div",{children:[/*#__PURE__*/t(c,{color:"var(--privy-color-error)"}),g.icon]})}),/*#__PURE__*/e(A,{children:[/*#__PURE__*/t("h3",{children:g.title}),"string"==typeof g.detail?/*#__PURE__*/t("p",{children:g.detail}):g.detail]}),/*#__PURE__*/t(a,{color:"var(--privy-color-error)",onClick:()=>{i instanceof p&&(i.privyErrorCode===d.INVALID_CAPTCHA&&l(),i.privyErrorCode===d.ALLOWLIST_REJECTED&&h.allowlistConfig.errorCtaLink)?window.location.href=h.allowlistConfig.errorCtaLink:n?.()},children:g.ctaText})]})]})};let v=/*#__PURE__*/n.div.withConfig({displayName:"ConnectContainer",componentId:"sc-f1b9e2cb-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px;width:100%;padding-bottom:16px;"]),A=/*#__PURE__*/n.div.withConfig({displayName:"GappedContainer",componentId:"sc-f1b9e2cb-1"})(["display:flex;flex-direction:column;gap:8px;"]),I=/*#__PURE__*/n.a.withConfig({displayName:"Link",componentId:"sc-f1b9e2cb-2"})(["color:var(--privy-color-accent) !important;font-weight:600;"]);export{w as ErrorScreen,x as ErrorScreenView};
